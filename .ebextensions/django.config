container_commands:
  01_collectstatic:
    command: "source /opt/python/run/venv/bin/activate && python manage.py collectstatic --noinput"

files:
  "/etc/apache2/sites-enabled/ssl_enabled.conf":
    mode: "000644"
    owner: root
    group: root
    encoding: plain
    content: |
      <VirtualHost *:80>
      RewriteEngine On
      RewriteCond %{HTTP:X-Forwarded-Proto} =http
      RewriteRule .* https://%{HTTP:Host}%{REQUEST_URI} [L,R=permanent]
      </VirtualHost>

option_settings:
  aws:elasticbeanstalk:container:python:
    WSGIPath: docsite/wsgi.py